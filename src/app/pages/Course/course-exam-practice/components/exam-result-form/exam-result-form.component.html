<nz-modal [(nzVisible)]="isVisible"
    [nzTitle]="isEdit ? 'Cập nhật kết quả' : (type === 2 ? 'KẾT QUẢ THỰC HÀNH' : 'KẾT QUẢ BÀI TẬP')"
    (nzOnCancel)="handleCancel()" [nzWidth]="700" [nzFooter]="modalFooter" nzClassName="exam-result-modal"
    [nzStyle]="{ top: '20px' }">

    <ng-container *nzModalContent>
        <form nz-form [formGroup]="validateForm" class="exam-result-form-container" nzLayout="vertical">
            <nz-row [nzGutter]="16">
                <nz-col [nzSpan]="24">
                    <nz-form-item>
                        <nz-form-label nzRequired>Khoá học</nz-form-label>
                        <nz-form-control nzErrorTip="Vui lòng chọn khoá học!">
                            <app-course-selector [allCourseData]="allCourseData"
                                [selectedCourseId]="validateForm.get('CourseID')?.value" [isLoading]="isLoading"
                                (courseSelected)="onCourseSelected($event)">
                            </app-course-selector>
                        </nz-form-control>
                    </nz-form-item>
                </nz-col>

                <nz-col [nzSm]="16" [nzXs]="24">
                    <nz-form-item>
                        <nz-form-label nzRequired>Nhân viên</nz-form-label>
                        <nz-form-control nzErrorTip="Vui lòng chọn nhân viên!">
                            <nz-select formControlName="EmployeeId" nzShowSearch nzPlaceHolder="Chọn nhân viên">
                                <nz-option-group *ngFor="let group of groupedEmployees"
                                    [nzLabel]="'Phòng ban: ' + group.department">
                                    <nz-option *ngFor="let emp of group.employees" [nzValue]="emp.ID"
                                        [nzLabel]="emp.Code + ' - ' + emp.FullName"></nz-option>
                                </nz-option-group>
                            </nz-select>
                        </nz-form-control>
                    </nz-form-item>
                </nz-col>

                <nz-col [nzSm]="8" [nzXs]="24">
                    <nz-form-item>
                        <nz-form-label>Loại</nz-form-label>
                        <nz-form-control>
                            <nz-select formControlName="ExamType" [nzDisabled]="'true'">
                                <nz-option [nzValue]="2" nzLabel="Thực hành"></nz-option>
                                <nz-option [nzValue]="3" nzLabel="Bài tập"></nz-option>
                            </nz-select>
                        </nz-form-control>
                    </nz-form-item>
                </nz-col>

                <nz-col [nzSm]="18" [nzXs]="24">
                    <nz-form-item>
                        <nz-form-label>Điểm thi</nz-form-label>
                        <nz-form-control>
                            <nz-input-number formControlName="PracticePoints" [nzMin]="0" [nzMax]="100" [nzStep]="1"
                                class="w-100"></nz-input-number>
                        </nz-form-control>
                    </nz-form-item>
                </nz-col>

                <nz-col [nzSm]="6" [nzXs]="24" class="d-flex align-items-end pb-3">
                    <nz-form-item class="mb-0">
                        <nz-form-control>
                            <label nz-checkbox formControlName="Evaluate">Đạt</label>
                        </nz-form-control>
                    </nz-form-item>
                </nz-col>

                <nz-col [nzSpan]="24">
                    <nz-form-item>
                        <nz-form-label nzFor="Note">Ghi chú</nz-form-label>
                        <nz-form-control>
                            <textarea rows="4" nz-input formControlName="Note" placeholder="Nhập ghi chú..."></textarea>
                        </nz-form-control>
                    </nz-form-item>
                </nz-col>
            </nz-row>
        </form>
    </ng-container>

    <ng-template #modalFooter>
        <button nz-button nzType="default" (click)="handleCancel()">Hủy</button>
        <button nz-button nzType="primary" (click)="handleSave()" [nzLoading]="isLoading"
            [disabled]="!validateForm.valid">
            Lưu
        </button>
    </ng-template>
</nz-modal>