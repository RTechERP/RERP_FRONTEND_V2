<ng-container class="w-100">
  <div class="card h-100 border-0 rounded-0">
    <div class="card-header bg-white p-2">
      <div class="d-flex justify-content-between align-items-center">
        <div class="d-flex gap-2">
          <button nz-button nzType="default" nzSize="small" (click)="openAddModal()" style="font-size: 0.75rem; font-weight: bold;">
            <nz-icon nzType="plus" /> Thêm
          </button>
          <button nz-button nzType="default" nzSize="small" (click)="openEditModal()" style="font-size: 0.75rem; font-weight: bold;">
            <nz-icon nzType="edit" /> Sửa
          </button>
          <button nz-button nzType="default" nzSize="small" (click)="openDeleteModal()" style="font-size: 0.75rem; font-weight: bold;">
            <nz-icon nzType="delete" /> Xóa
          </button>
        </div>
        <!-- <div class="d-flex gap-2">
          <nz-input-group nzPrefixIcon="search" nzSize="small">
            <input type="text" nz-input placeholder="Tìm kiếm..." (input)="onSearch($event)" />
          </nz-input-group>
        </div> -->
      </div>
    </div>

    <div class="card-body p-0 position-relative">
      <div *ngIf="isLoading">
        <nz-spin
          [nzSpinning]="isLoading"
          nzSimple
          [style]="{
            position: 'absolute',
            top: '0',
            left: '0',
            width: '100%',
            height: '100%',
            background: 'rgba(255,255,255,0.4)',
            zIndex: '999',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center'
          }"
        ></nz-spin>
      </div>
      <div id="tb_department"></div>
    </div>
  </div>
</ng-container>

<nz-modal [(nzVisible)]="isVisible" 
  [nzTitle]="isEditMode ? 'SỬA PHÒNG BAN' : 'THÊM PHÒNG BAN MỚI'" 
  (nzOnCancel)="handleCancel()" 
  (nzOnOk)="handleOk()"
  [nzOkText]="'Lưu'"
  [nzCancelText]="'Hủy'"
  [nzOkLoading]="isSubmitting">
  <ng-container *nzModalContent>
    <form nz-form [formGroup]="departmentForm" (ngSubmit)="onSubmit()">
      <nz-form-item>
        <nz-form-label [nzSpan]="24">Số thứ tự  <span class="text-danger"> (*)</span></nz-form-label>
        <nz-form-control [nzSpan]="24">
          <input nz-input type="number" formControlName="STT" [readonly]="true" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="24">Mã phòng ban<span class="text-danger"> (*)</span></nz-form-label>
        <nz-form-control [nzSpan]="24" nzErrorTip="Vui lòng nhập mã phòng ban">
          <input nz-input formControlName="Code" placeholder="Nhập mã phòng ban" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="24">Tên phòng ban <span class="text-danger"> (*)</span></nz-form-label>
        <nz-form-control [nzSpan]="24" nzErrorTip="Vui lòng nhập tên phòng ban">
          <input nz-input formControlName="Name" placeholder="Nhập tên phòng ban" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="24">Email</nz-form-label>
        <nz-form-control [nzSpan]="24">
          <input nz-input type="email" formControlName="Email" placeholder="Nhập email" />
        </nz-form-control>
      </nz-form-item>

      <nz-form-item>
        <nz-form-label [nzSpan]="24">Trưởng phòng <span class="text-danger"> (*)</span></nz-form-label>
        <nz-form-control [nzSpan]="24" nzErrorTip="Vui lòng chọn trưởng phòng">
          <nz-select class="w-100" nzShowSearch nzAllowClear nzSize="default"
            formControlName="HeadofDepartment" nzPlaceHolder="Chọn trưởng phòng"
            [nzOptions]="employeeList">
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </form>
  </ng-container>
</nz-modal>
