<div class="card border-0 rounded-0 h-100 d-flex flex-column">
    <!-- Header với search và buttons -->
    <div class="card-header bg-white p-2 flex-shrink-0">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
            <h6 class="m-0 text-uppercase fw-bold">Quản lý tài sản cá nhân</h6>
            <div class="d-flex gap-2 align-items-center flex-wrap">
                <!-- Search form -->
                <form nz-form nzLayout="inline" class="d-flex gap-2 align-items-end flex-wrap">
                    <nz-form-item>
                        <nz-form-label class="mb-1" style="font-size: 12px;">Từ ngày</nz-form-label>
                        <nz-form-control>
                            <nz-date-picker 
                                [(ngModel)]="dateStart" 
                                nzPlaceHolder="Từ ngày" 
                                nzFormat="dd/MM/yyyy"
                                nzSize="small"
                                name="dateStart"
                                style="width: 120px;">
                            </nz-date-picker>
                        </nz-form-control>
                    </nz-form-item>
                    
                    <nz-form-item>
                        <nz-form-label class="mb-1" style="font-size: 12px;">Đến ngày</nz-form-label>
                        <nz-form-control>
                            <nz-date-picker 
                                [(ngModel)]="dateEnd" 
                                nzPlaceHolder="Đến ngày" 
                                nzFormat="dd/MM/yyyy"
                                nzSize="small"
                                name="dateEnd"
                                style="width: 120px;">
                            </nz-date-picker>
                        </nz-form-control>
                    </nz-form-item>

                    <nz-form-item>
                        <nz-form-label class="mb-1" style="font-size: 12px;">Loại tài sản</nz-form-label>
                        <nz-form-control>
                            <nz-select 
                                nzPlaceHolder="Loại tài sản" 
                                [(ngModel)]="assetCategory"
                                nzSize="small"
                                name="assetCategory"
                                style="width: 120px;">
                                <nz-option 
                                    *ngFor="let item of assetCategoryList" 
                                    [nzLabel]="item.label" 
                                    [nzValue]="item.value">
                                </nz-option>
                            </nz-select>
                        </nz-form-control>
                    </nz-form-item>

                    <nz-form-item>
                        <nz-form-label class="mb-1" style="font-size: 12px;">Từ khóa</nz-form-label>
                        <nz-form-control>
                            <input 
                                nz-input 
                                placeholder="Từ khóa..." 
                                [(ngModel)]="keyword"
                                nzSize="small"
                                name="keyword"
                                style="width: 150px;" />
                        </nz-form-control>
                    </nz-form-item>
                </form>

                <button nz-button nzType="default" nzSize="small" (click)="resetSearch()">
                    Đặt lại
                </button>
                
                <button nz-button nzType="primary" nzSize="small" (click)="onSearch()">
                    <span nz-icon nzType="search"></span>
                    Tìm kiếm
                </button>
            </div>
        </div>
    </div>

    <!-- Tabs -->
    <div class="card-body p-1 position-relative flex-grow-1" style="min-height: 0; height: 100%;">
        <nz-tabset class="approval-tabs" [(nzSelectedIndex)]="selectedTabIndex" (nzSelectedIndexChange)="onTabChange($event)">
            <!-- Tab 1: Biên bản -->
            <nz-tab nzTitle="Biên bản">
                <ng-template #nzTabTitle>
                    <span class="custom-tab-title">Biên bản</span>
                </ng-template>
                <nz-spin [nzSpinning]="isLoading" nzTip="Đang tải dữ liệu..." style="height: calc(100vh - 180px);">
                    <nz-splitter nzLayout="vertical" style="height: 100%; flex: 1;">
                        <!-- Bảng Master - Biên bản (ở trên) - 60% -->
                        <nz-splitter-panel [nzCollapsible]="false" [nzResizable]="false" nzSize="50%">
                            <div #recordsTable style="height: 100%; width: 100%; overflow: auto;"></div>
                        </nz-splitter-panel>

                        <!-- Bảng Detail - Chi tiết cấp phát (ở dưới) - 40% -->
                        <nz-splitter-panel [nzCollapsible]="false" [nzResizable]="false" nzSize="50%">
                            <div style="height: 100%; display: flex; flex-direction: column;">
                                <nz-tabset style="padding-left: 10px; flex: 1; height: 0;">
                                    <nz-tab [nzTitle]="detailTabTitle">
                                        <div #recordDetailTable style="height: 100%; width: 100%; overflow: auto;"></div>
                                    </nz-tab>
                                </nz-tabset>
                            </div>
                        </nz-splitter-panel>
                    </nz-splitter>
                </nz-spin>
            </nz-tab>

            <!-- Tab 2: Tài sản cá nhân -->
            <nz-tab nzTitle="Tài sản cá nhân">
                <ng-template #nzTabTitle>
                    <span class="custom-tab-title">Tài sản cá nhân</span>
                </ng-template>
                <nz-spin [nzSpinning]="isLoading" nzTip="Đang tải dữ liệu..." style="height: 100%;">
                    <div #assetsTable style="height: 70vh;"></div>
                </nz-spin>
            </nz-tab>
        </nz-tabset>
    </div>
</div>
