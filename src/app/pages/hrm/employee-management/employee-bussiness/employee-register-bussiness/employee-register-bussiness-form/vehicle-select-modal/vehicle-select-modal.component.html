<div class="modal-header bg-primary align-items-center p-2">
  <h6 class="text-light text-uppercase m-0" style="padding: 0.5rem">
    Chọn phương tiện
  </h6>
  <button type="button" class="btn-close" (click)="cancel()" aria-label="Close"></button>
</div>

<div class="modal-body p-3" style="max-height: 70vh; overflow-y: auto;">
  <div class="alert alert-info mb-3" style="font-size: 12px;">
    <i nz-icon nzType="info-circle" nzTheme="outline"></i>
    <span class="ms-1">
      Các chi phí phương tiện ngoài xe máy cá nhân, CBNV làm đề nghị thanh toán chi phí trên phần mềm theo quy định. (Không gộp vào với khai báo công tác).
    </span>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-sm">
      <thead class="table-light">
        <tr>
          <th class="text-center align-middle" style="width: 50px; vertical-align: middle; text-align: center;">
            <div class="d-flex justify-content-center align-items-center" *ngIf="!isViewMode" style="width: 100%; height: 100%;">
              <button 
                type="button" 
                class="btn btn-link p-0" 
                (click)="addVehicleRow()"
                title="Thêm phương tiện"
                style="border: none; background: none; cursor: pointer; display: flex; align-items: center; justify-content: center; margin: 0 auto;"
              >
                <img src="assets/icon/add-button.png" alt="Thêm phương tiện" style="width: 24px; height: 24px; display: block;" />
              </button>
            </div>
          </th>
          <th class="text-center" style="text-align: center;">Phương tiện</th>
          <th class="text-center" style="width: 150px; text-align: center;">Chi phí</th>
          <th class="text-center" style="text-align: center;">Ghi chú</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of vehicleItems; let i = index" [id]="item.id">
          <td class="text-center">
            <button 
              nz-button 
              nzType="default" 
              nzSize="small" 
              nzDanger
              (click)="removeVehicleRow(item.id)"
              [disabled]="vehicleItems.length === 1 || isViewMode"
            >
              <span nz-icon nzType="delete" nzTheme="outline"></span>
            </button>
          </td>
          <td>
            <div class="form-group mb-2">
              <nz-select
                [(ngModel)]="item.vehicleId"
                (ngModelChange)="onVehicleChange(item)"
                nzPlaceHolder="Chọn phương tiện"
                style="width: 100%"
                [nzDisabled]="isViewMode"
              >
                <nz-option [nzValue]="0" nzLabel="Phương tiện khác"></nz-option>
                <nz-option *ngFor="let vehicle of vehicleList" [nzValue]="vehicle.ID" [nzLabel]="vehicle.VehicleName"></nz-option>
              </nz-select>
            </div>
            <div class="form-group mb-0" *ngIf="item.vehicleId === 0">
              <label class="m-0" style="font-size: 12px;">Tên <span class="text-danger">(*)</span></label>
              <input
                type="text"
                [(ngModel)]="item.customName"
                class="form-control form-control-sm"
                placeholder="Nhập tên phương tiện"
                [disabled]="isViewMode"
              />
            </div>
          </td>
          <td>
            <nz-input-number
              [(ngModel)]="item.cost"
              [nzMin]="0"
              [nzFormatter]="formatter"
              [nzParser]="parser"
              [nzDisabled]="true"
              style="width: 100%"
            ></nz-input-number>
          </td>
          <td>
            <input
              type="text"
              [(ngModel)]="item.note"
              class="form-control form-control-sm"
              placeholder="Nhập ghi chú"
              [disabled]="isViewMode"
            />
          </td>
        </tr>
      </tbody>
    </table>
  </div>

 
</div>

<div class="modal-footer bg-white p-2 d-flex justify-content-end gap-2">
  <button nz-button nzDanger nzType="default" (click)="cancel()">
    Đóng
  </button>
  <button nz-button nzType="primary" (click)="validateAndSave()" *ngIf="!isViewMode">
    Lưu
  </button>
</div>

