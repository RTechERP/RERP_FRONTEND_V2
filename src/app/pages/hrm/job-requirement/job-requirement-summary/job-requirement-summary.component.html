<div class="modal-dialog-scrollable">
  <div class="modal-header bg-primary py-2">
    <h6 class="modal-title text-white m-0">TỔNG HỢP YÊU CẦU CÔNG VIỆC</h6>
    <button type="button" class="btn-close btn-close" (click)="closeModal()" aria-label="Close"></button>
  </div>
  <div class="modal-body p-2">
    <div class="card border-0 rounded-0 h-100 d-flex flex-column">
      <!-- Header với search và buttons -->
      <div class="card-header bg-white p-2 flex-shrink-0">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
      
          <div class="d-flex gap-2 align-items-center flex-wrap">
            <!-- Search form -->
            <form nz-form nzLayout="inline" class="d-flex gap-2 align-items-end flex-wrap">
              <nz-form-item>
                <nz-form-label class="mb-1" style="font-size: 12px;">Từ ngày</nz-form-label>
                <nz-form-control>
                  <nz-date-picker 
                    [(ngModel)]="dateStart" 
                    nzPlaceHolder="Từ ngày" 
                    nzFormat="dd/MM/yyyy"
                    nzSize="small"
                    name="dateStart"
                    style="width: 120px;">
                  </nz-date-picker>
                </nz-form-control>
              </nz-form-item>
              
              <nz-form-item>
                <nz-form-label class="mb-1" style="font-size: 12px;">Đến ngày</nz-form-label>
                <nz-form-control>
                  <nz-date-picker 
                    [(ngModel)]="dateEnd" 
                    nzPlaceHolder="Đến ngày" 
                    nzFormat="dd/MM/yyyy"
                    nzSize="small"
                    name="dateEnd"
                    style="width: 120px;">
                  </nz-date-picker>
                </nz-form-control>
              </nz-form-item>

              <nz-form-item>
                <nz-form-label class="mb-1" style="font-size: 12px;">Phòng ban</nz-form-label>
                <nz-form-control>
                  <nz-select 
                    nzPlaceHolder="Phòng ban" 
                    [(ngModel)]="departmentID"
                    nzSize="small"
                    nzShowSearch
                    nzAllowClear
                    name="departmentID"
                    style="width: 150px;">
                    <nz-option 
                      *ngFor="let item of departmentList" 
                      [nzLabel]="item.Name || ''" 
                      [nzValue]="item.ID">
                    </nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>

              <nz-form-item>
                <nz-form-label class="mb-1" style="font-size: 12px;">Nhân viên</nz-form-label>
                <nz-form-control>
                  <nz-select 
                    nzPlaceHolder="Nhân viên" 
                    [(ngModel)]="employeeID"
                    nzSize="small"
                    nzShowSearch
                    nzAllowClear
                    name="employeeID"
                    style="width: 200px;">
                    <nz-option 
                      *ngFor="let item of employeeList" 
                      [nzLabel]="(item.Code || '') + ' - ' + (item.FullName || '')" 
                      [nzValue]="item.ID">
                    </nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>

              <nz-form-item>
                <nz-form-label class="mb-1" style="font-size: 12px;">Trạng thái</nz-form-label>
                <nz-form-control>
                  <nz-select 
                    nzPlaceHolder="Bước" 
                    [(ngModel)]="step"
                    nzSize="small"
                    nzAllowClear
                    name="step"
                    style="width: 100px;">
                    <nz-option 
                      *ngFor="let item of stepList" 
                      [nzLabel]="item.label" 
                      [nzValue]="item.value">
                    </nz-option>
                  </nz-select>
                </nz-form-control>
              </nz-form-item>

              <nz-form-item>
                <nz-form-label class="mb-1" style="font-size: 12px;">Từ khóa</nz-form-label>
                <nz-form-control>
                  <input 
                    nz-input 
                    placeholder="Từ khóa" 
                    [(ngModel)]="request"
                    nzSize="small"
                    name="request"
                    style="width: 150px;" />
                </nz-form-control>
              </nz-form-item>

            
            </form>
            <button nz-button nzType="default" nzSize="small" (click)="resetSearch()">
              Đặt lại
            </button>
            
            <button nz-button nzType="primary" nzSize="small" (click)="loadData()">
              Tìm kiếm
            </button>
            <button nz-button nzType="default" nzSize="small" (click)="exportToExcel()">
              <img src="assets/icon/action_export_excel_16.png" alt="Xuất Excel" style="width:16px; height:16px; object-fit:contain" />
              Xuất Excel
            </button>
          </div>
        </div>
      </div>

      <!-- Table -->
      <div class="card-body p-1 position-relative flex-grow-1" style="min-height: 0; height: 100%;">
        <nz-spin [nzSpinning]="isLoading" nzTip="Đang tải dữ liệu..." style="height: 100%;">
          <div #summaryTable style="height: 100%;"></div>
        </nz-spin>
      </div>
    </div>
  </div>
</div>
