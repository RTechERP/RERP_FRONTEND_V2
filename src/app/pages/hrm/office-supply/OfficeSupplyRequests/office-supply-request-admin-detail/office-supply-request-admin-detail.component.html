<div class="modal-dialog-scrollable">
  <div class="modal-header bg-primary align-items-center ps-2">
    <h6 class="text-light text-uppercase m-0" style="padding: 0, 5rem">
      ĐĂNG KÝ VPP ADMIN
    </h6>
    <button type="button" class="btn-close" (click)="close()" aria-label="Close"></button>
  </div>

  <div class="modal-body p-2 w-100 pt-0">
    <div class="card h-100 border-0 rounded-0">
      <!-- Form Header -->
      <div class="card-header bg-white p-2">
        <nz-row [nzGutter]="16">
          <nz-col [nzSpan]="8">
            <nz-form-item>
              <nz-form-label>Ngày đăng ký</nz-form-label>
              <nz-form-control>
                <nz-date-picker
                  [(ngModel)]="dateRequest"
                  name="dateRequest"
                  nzFormat="dd/MM/yyyy"
                  nzPlaceHolder="Chọn ngày đăng ký"
                  class="w-100"
                  nzSize="small"
                ></nz-date-picker>
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="8">
            <nz-form-item>
              <nz-form-label>Phòng ban</nz-form-label>
              <nz-form-control>
                <nz-select
                  [(ngModel)]="departmentId"
                  name="departmentId"
                  nzShowSearch
                  nzAllowClear
                  nzPlaceHolder="Chọn phòng ban"
                  class="w-100"
                  nzSize="small"
                  (ngModelChange)="onDepartmentChange()"
                >
                  <nz-option
                    *ngFor="let dept of departmentList"
                    [nzValue]="dept.ID"
                    [nzLabel]="dept.Name"
                  >
                    {{ dept.Code }} - {{ dept.Name }}
                  </nz-option>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </nz-col>

          <nz-col [nzSpan]="8">
            <nz-form-item>
              <nz-form-label>Người đăng ký</nz-form-label>
              <nz-form-control>
                <nz-select
                  [(ngModel)]="requesterId"
                  name="requesterId"
                  nzShowSearch
                  nzAllowClear
                  nzPlaceHolder="Chọn người đăng ký"
                  class="w-100"
                  nzSize="small"
                >
                  <nz-option-group
                    *ngFor="let group of employeeGroups"
                    [nzLabel]="group.label"
                  >
                    <nz-option
                      *ngFor="let emp of group.options"
                      [nzValue]="emp.ID || emp.EmployeeID"
                      [nzLabel]="emp.Code + ' - ' + emp.FullName"
                    >
                      {{ emp.Code }} - {{ emp.FullName }}
                    </nz-option>
                  </nz-option-group>
                </nz-select>
              </nz-form-control>
            </nz-form-item>
          </nz-col>
        </nz-row>
      </div>

      <!-- Tabs -->
      <div class="card-body p-2 position-relative">
        <div *ngIf="isLoading || isSaving">
          <nz-spin [nzSpinning]="isLoading || isSaving" nzSimple [style]="{
            position: 'absolute',
            top: '0',
            left: '0',
            width: '100%',
            height: '100%',
            background: 'rgba(255,255,255,0.4)',
            zIndex: '999',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center'
          }"></nz-spin>
        </div>

        <nz-tabset [nzSelectedIndex]="activeTabIndex" (nzSelectChange)="onTabChange($event)">
          <!-- Tab 1: Chọn nhân viên -->
          <nz-tab nzTitle="Chọn nhân viên">
            <div #tbEmployee class="border" style="height: 70vh; overflow: auto;"></div>
          </nz-tab>

          <!-- Tab 2: Đăng ký VPP -->
          <nz-tab nzTitle="Đăng ký VPP">
            <div #tbRequestDetail class="border" style="height: 70vh; overflow: auto;"></div>
          </nz-tab>
        </nz-tabset>
      </div>
    </div>
  </div>

  <div class="modal-footer br p-1 d-flex align-items-center">
    <div class="d-flex align-items-center flex-wrap gap-1">
      <button
        type="button"
        class="btn btn-outline-danger"
        style="border: 1px solid; border-radius: 0;"
        (click)="close()"
        [disabled]="isSaving"
      >
        Đóng
      </button>
      <button
        type="button"
        style="border-radius: 0;"
        class="btn btn-primary"
        (click)="save()"
        [disabled]="isSaving"
      >
        <span *ngIf="!isSaving">Lưu</span>
        <span *ngIf="isSaving">
       
          Đang lưu...
        </span>
      </button>
    </div>
  </div>
</div>
