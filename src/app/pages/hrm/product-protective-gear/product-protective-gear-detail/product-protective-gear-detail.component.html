<div class="modal-content">
  <div class="modal-header bg-primary py-2">
    <h5 class="modal-title text-uppercase text-light" id="staticBackdropLabel">CHI TIẾT SẢN PHẨM</h5>
    <button type="button" class="btn-close" aria-label="Close" (click)="activeModal.close()"></button>
  </div>
  <div class="modal-body">
    <form nz-form nzLayout="vertical" [formGroup]="validateForm">
      <nz-row [nzGutter]="16">
        <!-- Cột trái - Thông tin sản phẩm -->
        <nz-col [nzSpan]="12">
          <!-- Mã nhóm -->
          <nz-form-item>
            <nz-form-label>Mã nhóm<span class="text-danger ps-1">(*)</span></nz-form-label>
            <nz-form-control nzErrorTip="Chọn mã nhóm">
              <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Chọn nhóm"
                [formControlName]="productProtectiveGearField.ProductGroupRTCID.field">
                @for (item of productGroups; track item) {
                <nz-option [nzLabel]="item.ProductGroupNo + ' - ' + item.ProductGroupName"
                  [nzValue]="item.ID"></nz-option>
                }
              </nz-select>
            </nz-form-control>
          </nz-form-item>

          <!-- Mã sản phẩm -->
          <nz-form-item>
            <nz-form-label>Mã sản phẩm<span class="text-danger ps-1">(*)</span></nz-form-label>
            <nz-form-control nzErrorTip="Nhập mã sản phẩm">
              <input nz-input [formControlName]="productProtectiveGearField.ProductCode.field"
                placeholder="Nhập mã sản phẩm">
            </nz-form-control>
          </nz-form-item>

          <!-- Tên sản phẩm -->
          <nz-form-item>
            <nz-form-label>Tên sản phẩm<span class="text-danger ps-1">(*)</span></nz-form-label>
            <nz-form-control nzErrorTip="Nhập tên sản phẩm">
              <input nz-input [formControlName]="productProtectiveGearField.ProductName.field"
                placeholder="Nhập tên sản phẩm">
            </nz-form-control>
          </nz-form-item>

          <!-- Đơn vị tính -->
          <nz-form-item>
            <nz-form-label>Đơn vị tính<span class="text-danger ps-1">(*)</span></nz-form-label>
            <nz-form-control nzErrorTip="Chọn đơn vị tính">
              <div class="select-with-button">
                <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Chọn đơn vị"
                  [formControlName]="productProtectiveGearField.UnitCountID.field">
                  @for (item of units; track item) {
                  <nz-option [nzLabel]="item.UnitName" [nzValue]="item.ID"></nz-option>
                  }
                </nz-select>
                <button nz-button nzType="primary" nzSize="small" (click)="onAddUnit()" class="quick-add-btn"
                  title="Thêm đơn vị tính mới">
                  <nz-icon nzType="plus" nzTheme="outline"></nz-icon>
                </button>
              </div>
            </nz-form-control>
          </nz-form-item>

          <!-- Hãng -->
          <nz-form-item>
            <nz-form-label>Hãng</nz-form-label>
            <nz-form-control>
              <div class="select-with-button">
                <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Chọn hãng"
                  [formControlName]="productProtectiveGearField.FirmID.field">
                  @for (item of makers; track item) {
                  <nz-option [nzLabel]="item.FirmName" [nzValue]="item.ID"></nz-option>
                  }
                </nz-select>
                <button nz-button nzType="primary" nzSize="small" (click)="onAddFirm()" class="quick-add-btn"
                  title="Thêm hãng mới">
                  <nz-icon nzType="plus" nzTheme="outline"></nz-icon>
                </button>
              </div>
            </nz-form-control>
          </nz-form-item>

          <!-- Vị trí -->
          <nz-form-item>
            <nz-form-label>Vị trí</nz-form-label>
            <nz-form-control>
              <div class="select-with-button">
                <nz-select nzShowSearch nzAllowClear nzPlaceHolder="Chọn vị trí"
                  [formControlName]="productProtectiveGearField.ProductLocationID.field">
                  @for (item of locations; track item) {
                  <nz-option [nzLabel]="item.LocationName" [nzValue]="item.ID"></nz-option>
                  }
                </nz-select>
                <button nz-button nzType="primary" nzSize="small" (click)="onAddLocation()" class="quick-add-btn"
                  title="Thêm vị trí mới">
                  <nz-icon nzType="plus" nzTheme="outline"></nz-icon>
                </button>
              </div>
            </nz-form-control>
          </nz-form-item>


          <!-- Size -->
          <nz-form-item>
            <nz-form-label>Size</nz-form-label>
            <nz-form-control>
              <input nz-input [formControlName]="productProtectiveGearField.Size.field" placeholder="Nhập size">
            </nz-form-control>
          </nz-form-item>

          <!-- Ghi chú -->
          <nz-form-item>
            <nz-form-label>Ghi chú</nz-form-label>
            <nz-form-control>
              <textarea rows="4" [formControlName]="productProtectiveGearField.Note.field" nz-input
                placeholder="Nhập ghi chú"></textarea>
            </nz-form-control>
          </nz-form-item>
        </nz-col>

        <!-- Cột phải - Ảnh -->
        <nz-col [nzSpan]="12">
          <nz-form-item>
            <nz-form-label>Ảnh</nz-form-label>
            <nz-form-control>
              <div class="image-preview-container">
                @if (imagePreview) {
                <img [src]="imagePreview" alt="Preview">
                } @else {
                <span class="no-image-text">Chưa có ảnh</span>
                }
              </div>
              <div class="mt-2 d-flex gap-2">
                <nz-upload 
                  [nzShowUploadList]="false"
                  [nzBeforeUpload]="handleBeforeUpload"
                  nzAccept="image/*"
                  [nzMultiple]="false">
                  <button nz-button nzType="default">
                    <nz-icon nzType="upload" nzTheme="outline"></nz-icon>
                    Chọn ảnh
                  </button>
                </nz-upload>
              </div>
            </nz-form-control>
          </nz-form-item>
        </nz-col>
      </nz-row>
    </form>
  </div>
  <div class="modal-footer py-2">
    <button nz-button nzType="default" nzDanger="" (click)="activeModal.close()">
      <nz-icon nzType="close" nzTheme="outline" /> Đóng
    </button>
    <button nz-button nzType="primary" (click)="submitForm()" [nzLoading]="saving" [disabled]="saving">
      <nz-icon nzType="save" nzTheme="outline" /> Lưu
    </button>
  </div>
</div>