<div class="modal-header bg-primary p-2">
    <h6 class="modal-title text-white">ĐỀ XUẤT BÁO SỬA XE NỘI BỘ</h6>
    <button type="button" class="btn-close" aria-label="Close" (click)="close()"></button>
</div>

<div class="modal-body p-1 " style="max-height: 60vh; overflow-y: auto; overflow-x: hidden;">
    <nz-tabset (nzSelectedIndexChange)="onTabChange($event)">
        <nz-tab nzTitle="Thông tin đề xuất" [nzForceRender]="true">
            <form [formGroup]="formGroup" class="row g-3 ">
                <nz-row [nzGutter]="5">
                    <nz-col [nzXs]="24" [nzMd]="12">
                        <fieldset class="reset mt-2">
                            <legend class="reset fs-12 p-0">THÔNG TIN XE</legend>
                            <nz-row [nzGutter]="16">
                                 <nz-col [nzXs]="24" [nzSm]="24">
                                    <nz-form-item class="col-md-12">
                                        <nz-form-label [nzSpan]="24">Chọn xe<span class="text-danger ps-1 me-1"> (*)
                                            </span>
                                        </nz-form-label>
                                        <nz-form-control [nzErrorTip]="'Chọn xe'">
                                            <nz-input-group required nzSearch nzSize="default" class="w-100">
                                                <nz-select nzSize="default" formControlName="VehicleManagementID"
                                                    name="VehicleManagementID" nzPlaceHolder="Chọn xe"
                                                    class="fs-12 w-100" required nzShowSearch nzAllowClear    [nzDisabled]="true">
                                                    <nz-option *ngFor="let item of vehicleList" [nzValue]="item.ID"
                                                        [nzLabel]="item.STT + ' - ' + item.VehicleName">
                                                    </nz-option>
                                                </nz-select>
                                            </nz-input-group>

                                        </nz-form-control>
                                    </nz-form-item>
                                </nz-col>
                            </nz-row>
                            <nz-row [nzGutter]="24">
                                <nz-col [nzSpan]="24">
                                    <nz-form-item class="col-md-12">
                                        <nz-form-label [nzSpan]="24">Biển số xe
                                        </nz-form-label>
                                        <nz-form-control [nzSpan]="24">
                                            <input nz-input formControlName="LicensePlate" name="LicensePlate"
                                                [disabled]="true" />
                                        </nz-form-control>
                                    </nz-form-item>
                                </nz-col>
                            </nz-row>
                        </fieldset>
                    </nz-col>
                    <nz-col [nzXs]="24" [nzMd]="12">
                        <fieldset class="reset mt-2">
                            <legend class="reset fs-12 p-0">THÔNG TIN LÁI XE</legend>
                          <nz-row [nzGutter]="16">
                                   <nz-col [nzXs]="24" [nzSm]="24">
                                    <nz-form-item class="col-md-12">
                                        <nz-form-label [nzSpan]="24">Chọn nhân viên<span class="text-danger ps-1 me-1">
                                                (*)
                                            </span>
                                        </nz-form-label>
                                        <nz-form-control [nzSpan]="24">
                                            <nz-input-group required nzSearch nzSize="default" class="w-100">
                                                <nz-select nzSize="default" formControlName="EmployeeID"
                                                    name="EmployeeID" nzPlaceHolder="Chọn nhân viên" class="fs-12 w-100"
                                                    required nzShowSearch nzAllowClear   [nzDisabled]="true">
                                                    <nz-option *ngFor="let item of employeeList" [nzValue]="item.ID"
                                                        [nzLabel]="item.Code + ' - ' + item.FullName">
                                                    </nz-option>
                                                </nz-select>
                                            </nz-input-group>
                                        </nz-form-control>
                                    </nz-form-item>
                                </nz-col>
                            </nz-row>
                           <nz-row [nzGutter]="16">
                                 <nz-col [nzXs]="12" [nzSm]="8">
                                    <nz-form-item class="col-md-12">
                                        <nz-form-label [nzSpan]="24">Mã NV<span class="text-danger ps-1 me-1"> (*)
                                            </span></nz-form-label>
                                        <nz-form-control [nzSpan]="24">
                                            <input nz-input type="text" formControlName="EmployeeCode"  />
                                        </nz-form-control>
                                    </nz-form-item>
                                </nz-col>
                               <nz-col [nzXs]="12" [nzSm]="16">
                                    <nz-form-item class="col-md-12">
                                        <nz-form-label [nzSpan]="24">SDT<span class="text-danger ps-1 "> (*)
                                            </span></nz-form-label>
                                        <nz-form-control [nzSpan]="24">
                                            <input nz-input formControlName="SDT" 
                                             />
                                        </nz-form-control>
                                    </nz-form-item>
                                </nz-col>
                            </nz-row>

                        </fieldset>
                    </nz-col>
                </nz-row>
                <nz-row [nzGutter]="5">
                   <nz-col [nzSpan]="24">
  <fieldset class="reset mt-2">
    <legend class="reset fs-12 p-0">THÔNG TIN SỬA CHỮA</legend>

    <!-- Hàng 1: Ngày -->
    <nz-row [nzGutter]="16">
      <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8">
        <nz-form-item class="col-md-12">
          <nz-form-label [nzSpan]="24">Ngày đề xuất<span class="text-danger ps-1 me-1"> (*)</span></nz-form-label>
          <nz-form-control [nzSpan]="24"
            [nzErrorTip]="formGroup.get('DateReport')?.invalid && (formGroup.get('DateReport')?.dirty || formGroup.get('DateReport')?.touched) ? 'Vui lòng nhập ngày đề xuất!' : undefined">
            <input nz-input type="date" placeholder="Chọn ngày đề xuất" formControlName="DateReport" />
          </nz-form-control>
        </nz-form-item>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8">
        <nz-form-item class="col-md-12">
          <nz-form-label [nzSpan]="24">Ngày bắt đầu<span class="text-danger ps-1 me-1"> (*)</span></nz-form-label>
          <nz-form-control [nzSpan]="24"
            [nzErrorTip]="formGroup.get('TimeStartRepair')?.invalid && (formGroup.get('TimeStartRepair')?.dirty || formGroup.get('TimeStartRepair')?.touched) ? 'Vui lòng chọn ngày bắt đầu!' : undefined">
            <input nz-input type="date" placeholder="Chọn ngày bắt đầu" formControlName="TimeStartRepair" />
          </nz-form-control>
        </nz-form-item>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8">
        <nz-form-item class="col-md-12">
          <nz-form-label [nzSpan]="24">Ngày kết thúc</nz-form-label>
          <nz-form-control [nzSpan]="24">
            <input nz-input type="date" placeholder="Nhập ngày kết thúc" formControlName="TimeEndRepair" />
          </nz-form-control>
        </nz-form-item>
      </nz-col>
    </nz-row>

    <!-- Hàng 2: Reason / ProposeContent / Note -->
    <nz-row [nzGutter]="16">
      <nz-col [nzXs]="24" [nzSm]="24" [nzMd]="8">
        <nz-form-item class="col-md-12">
          <nz-form-label [nzSpan]="24">Lý do đề xuất<span class="text-danger ps-1 me-1"> (*)</span></nz-form-label>
          <nz-form-control [nzSpan]="24"
            [nzErrorTip]="(formGroup.get('Reason')?.hasError('required') && (formGroup.get('Reason')?.dirty || formGroup.get('Reason')?.touched)) ? 'Vui lòng nhập lý do sửa chữa!' : undefined">
            <textarea nz-input class="ta-auto" rows="3" placeholder="Nhập lý do sửa chữa" formControlName="Reason"></textarea>
          </nz-form-control>
        </nz-form-item>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="24" [nzMd]="8">
        <nz-form-item class="col-md-12">
          <nz-form-label [nzSpan]="24">Nội dung đề xuất<span class="text-danger ps-1 me-1"> (*)</span></nz-form-label>
          <nz-form-control [nzSpan]="24"
            [nzErrorTip]="(formGroup.get('ProposeContent')?.hasError('required') && (formGroup.get('ProposeContent')?.dirty || formGroup.get('ProposeContent')?.touched)) ? 'Vui lòng nhập nội dung đề xuất!' : undefined">
            <textarea nz-input class="ta-auto" rows="3" placeholder="Nhập nội dung đề xuất" formControlName="ProposeContent"></textarea>
          </nz-form-control>
        </nz-form-item>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="24" [nzMd]="8">
        <nz-form-item class="col-md-12">
          <nz-form-label [nzSpan]="24">Ghi chú</nz-form-label>
          <nz-form-control [nzSpan]="24">
            <textarea nz-input class="ta-auto" rows="3" placeholder="Nhập ghi chú" formControlName="Note"></textarea>
          </nz-form-control>
        </nz-form-item>
      </nz-col>
    </nz-row>
  </fieldset>
</nz-col>
                </nz-row>

            </form>
        </nz-tab>
        <nz-tab nzTitle="Danh sách file đính kèm" [nzForceRender]="true">
            <div nz-col [nzSpan]="24">
                <div class="file-container">
                    <div class="file-upload-section mb-2">
                        <nz-upload [(nzFileList)]="fileList" [nzBeforeUpload]="beforeUpload" [nzMultiple]="true"
                            [nzShowUploadList]="false">
                            <button nz-button nzSize="small">
                                <i nz-icon nzType="upload"></i>
                                Thêm file đính kèm
                            </button>
                        </nz-upload>
                    </div>
                    <div #fileTable class="file-table"></div>
                </div>
            </div>
        </nz-tab>
        </nz-tabset>
    </div>
        <div class="modal-footer">
            <button nz-button nzType="default" nzDanger (click)="close()">Đóng</button>
            <button nz-button nzType="primary" (click)="save()">Lưu dữ liệu</button>
        </div>  