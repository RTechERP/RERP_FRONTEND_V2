<div class="modal-header bg-primary text-uppercase py-2 flex-shrink-0">
  <h6 class="modal-title text-white">Tổng hợp chi tiết phiếu xuất</h6>
  <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
</div>
<div class="modal-body p-1 flex-grow-1 overflow-hidden">
  <div class="d-flex gap-2 p-2 border-bottom">
    <button class="fs-12 btn" nz-button nzType="default" nzSize="small" title="Xuất Excel" (click)="exportExcel()">
      <nz-icon nzType="file-excel"></nz-icon> Xuất Excel
    </button>
  </div>
  <div class="tab-content">
    <div class="d-flex gap-2 p-2 border-bottom">
      <form nz-form nzLayout="inline" class="filter-bar d-flex flex-wrap align-items-center">
        <!-- Từ ngày -->
        <nz-form-item class="filter-item filter-item--date">
          <nz-form-control>
            <nz-date-picker
              [nzFormat]="dateFormat"
              nzSize="small"
              [(ngModel)]="searchParams.dateStart"
              name="dateStart"
              [nzDisabled]="checked"
              nzPlaceHolder="Từ ngày"
              class="w-100"
            ></nz-date-picker>
          </nz-form-control>
        </nz-form-item>

        <!-- Đến ngày -->
        <nz-form-item class="filter-item filter-item--date">
          <nz-form-control>
            <nz-date-picker
              [nzFormat]="dateFormat"
              nzSize="small"
              [(ngModel)]="searchParams.dateEnd"
              name="dateEnd"
              [nzDisabled]="checked"
              nzPlaceHolder="Đến ngày"
              class="w-100"
            ></nz-date-picker>
          </nz-form-control>
        </nz-form-item>

        <!-- Checkbox: Tất cả -->
        <nz-form-item class="filter-item filter-item--auto mb-0">
          <nz-form-control>
            <label nz-checkbox [(ngModel)]="checked" name="checked" (ngModelChange)="onCheckboxChange()">
              Tất cả
            </label>
          </nz-form-control>
        </nz-form-item>

        <!-- Lọc kho -->
        <nz-form-item class="filter-item filter-item--kho">
          <nz-form-control>
            <nz-select
              [(ngModel)]="selectedKhoTypes"
              (ngModelChange)="onKhoTypeChange($event)"
              [nzMode]="'multiple'"
              [nzPlaceHolder]="'Nhóm kho'"
              [nzMaxTagCount]="1"
              nzSize="small"
              class="w-100"
              name="selectedKhoTypes"
            >
              <nz-option
                *ngFor="let item of dataProductGroup"
                [nzLabel]="item.ProductGroupName"
                [nzValue]="item.ID"
              ></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>

        <!-- Lọc phiếu -->
        <nz-form-item class="filter-item filter-item--status">
          <nz-form-control>
            <nz-select
              nzShowSearch
              nzAllowClear
              nzSize="small"
              [(ngModel)]="searchParams.status"
              name="status"
              nzPlaceHolder="Trạng thái"
              class="w-100"
            >
              <nz-option *ngFor="let item of cbbStatus" [nzValue]="item.ID" [nzLabel]="item.Name">
                <div class="d-flex align-items-center">
                  <span class="me-2">{{ item.ID }}</span>
                  <span>{{ item.Name }}</span>
                </div>
              </nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>

        <!-- Từ khóa -->
        <nz-form-item class="filter-item filter-item--keyword">
          <nz-form-control>
            <input
              nz-input
              placeholder="Từ khóa"
              [(ngModel)]="searchParams.keyword"
              name="keyword"
              nzSize="small"
              class="w-100"
            />
          </nz-form-control>
        </nz-form-item>

        <!-- Nút tìm kiếm -->
        <nz-form-item class="filter-item filter-item--button">
          <nz-form-control>
            <button class="fs-12 btn w-100" nz-button nzType="primary" nzSize="small" (click)="loadDataBillExportSynthetic()">
              Tìm kiếm
            </button>
          </nz-form-control>
        </nz-form-item>
      </form>
    </div>
    <div class="card-body w-100" style="overflow-x: auto;">
      <nz-spin [nzSpinning]="isLoading" nzTip="Đang tải dữ liệu...">
        <div id="gridContainer" class="grid-container">
          <angular-slickgrid
            [gridId]="gridId"
            [columns]="columnDefinitions"
            [options]="gridOptions"
            [dataset]="dataset"
            (onAngularGridCreated)="angularGridReady($event.detail)"
          >
          </angular-slickgrid>
        </div>
      </nz-spin>
    </div>
  </div>
</div>
<div class="modal-footer flex-shrink-0">
  <button class="fs-12 btn" nz-button nzDanger (click)="closeModal()">Đóng</button>
</div>
