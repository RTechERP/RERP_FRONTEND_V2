<div class="modal-content">
  <div class="modal-header bg-primary text-uppercase py-2">
    <h6 class="modal-title text-white">NHẬP DỮ LIỆU EXCEL</h6>
    <button type="button" class="btn-close" (click)="closeExcelModal()"></button>
  </div>

  <div class="d-flex gap-2 align-items-center p-2">
    <div class="flex-grow-1">
      <div class="progress-wrapper">
        <div style="text-align: center;" class="progress-text">{{ formatProgressText() }}</div>
        <nz-progress [nzPercent]="displayProgress" [nzStrokeColor]="{ '0%': '#108ee9', '100%': '#87d068' }"
          [nzShowInfo]="false"></nz-progress>
      </div>
    </div>
  </div>

  <form class="needs-validation" novalidate>
    <div class="d-flex flex-column gap-2 p-3 pt-0">
      <div class="d-flex gap-2 align-items-center">
        <div class="d-flex align-items-center gap-2" style="flex: 2;">
          <label class="mb-0 fs-12" style="white-space: nowrap;">Đường dẫn:</label>
          <div class="d-flex gap-2 flex-grow-1">
            <input nz-input [style.width.%]="100" class="fs-12" name="path" [(ngModel)]="filePath" [disabled]="true">
            <input type="file" class="d-none fs-12" id="fileInput" accept=".xlsx,.xls"
              (change)="onFileSelected($event)">
            <button type="button" class="btn btn-warning btn-sm" (click)="openFileExplorer()" style="height: auto;">
              <i class="fas fa-folder-open"></i>
            </button>
          </div>
        </div>
        <div class="d-flex align-items-center gap-2" style="flex: 1;">
          <label class="mb-0 fs-12" style="white-space: nowrap;">Tên Sheet:</label>
          <select class="form-select form-select-sm fs-12" name="sheet" [(ngModel)]="selectedSheet"
            (change)="onSheetChange()">
            <option value="">Chọn Sheet</option>
            <option *ngFor="let s of excelSheets" [value]="s">{{ s }}</option>
          </select>
        </div>
      </div>
    </div>

    <div class="card-body p-3 pt-0">
      <div #tableContainer class="table-excel-container" style="height: 400px; overflow-y: auto;"></div>
    </div>

    <div class="modal-footer py-2 gap-2">
      <button nz-button nzDanger (click)="closeExcelModal()">Đóng</button>
      <button nz-button nzType="primary" (click)="saveExcelData()">Lưu</button>
    </div>
  </form>
</div>