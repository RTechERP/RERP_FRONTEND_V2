<!-- <div style="display: flex; flex-direction: column; height: 99.6vh; position: relative;"> -->

<ng-container class="w-100 h-100 d-flex flex-column">
    <!-- Header với p-menubar -->
    <div class="card-header bg-white p-0" style="flex-shrink: 0;">
      <p-menubar [model]="menuBars">
        <ng-template pTemplate="item" let-item>
          <a class="p-menuitem-link" [ngClass]="item.styleClass">
            <i [class]="item.icon"></i>
            <span class="p-menuitem-text">{{ item.label }}</span>
          </a>
        </ng-template>

        <ng-template #end>
          <div class="flex items-center gap-2">
            <button nz-button nzType="text" nzShape="circle"
              (click)="toggleSearchPanel(); $event.stopPropagation()">
              <nz-icon [nzType]="sizeSearch == '0' ? 'down' : 'up'" />
            </button>
          </div>
        </ng-template>
      </p-menubar>
    </div>
    <nz-splitter>
        <nz-splitter-panel [nzSize]="sizeSearch" nzResizable="false">
            <div class="card h-100 border-0 rounded-0">
                <div class="card-header bg-white p-1">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="m-0 ms-2">Tìm kiếm</h6>
                        <button class="border-0 me-2" nz-button nzSize="small" nzType="default" nzDanger
                            (click)="toggleSearchPanel()">
                            <nz-icon nzType="close" nzTheme="outline" />
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <form nz-form>
                        <nz-form-item>
                            <nz-form-label class="fs-12" [nzSpan]="24">Từ ngày</nz-form-label>
                            <nz-form-control [nzSpan]="24">
                                <nz-date-picker name="startDate" class="w-100" nzSize="small"
                                    [(ngModel)]="dateStart"></nz-date-picker>
                            </nz-form-control>
                        </nz-form-item>
                        <nz-form-item class="mt-2">
                            <nz-form-label class="fs-12" [nzSpan]="24">Đến ngày</nz-form-label>
                            <nz-form-control [nzSpan]="24">
                                <nz-date-picker name="endDate" class="w-100" nzSize="small"
                                    [(ngModel)]="dateEnd"></nz-date-picker>
                            </nz-form-control>
                        </nz-form-item>
                        <nz-form-item class="mt-2">
                            <nz-form-label class="fs-12" [nzSpan]="24">Khách hàng</nz-form-label>
                            <nz-form-control [nzSpan]="24">
                                <nz-select name="userId" class="w-100" nzShowSearch nzAllowClear nzSize="small"
                                    nzPlaceHolder="Người phụ trách" [(ngModel)]="customerId">
                                    <nz-option *ngFor="let item of customers" [nzValue]="item.ID"
                                        [nzLabel]="item.FullName"></nz-option>
                                </nz-select>
                            </nz-form-control>
                        </nz-form-item>
                        <nz-form-item class="mt-2">
                            <nz-form-label class="fs-12" [nzSpan]="24">Người yêu cầu</nz-form-label>
                            <nz-form-control [nzSpan]="24">
                                <nz-select name="userId" class="w-100" nzShowSearch nzAllowClear nzSize="small"
                                    nzPlaceHolder="Người phụ trách" [(ngModel)]="userId">
                                    <nz-option *ngFor="let item of users" [nzValue]="item.ID"
                                        [nzLabel]="item.FullName"></nz-option>
                                </nz-select>
                            </nz-form-control>
                        </nz-form-item>
                        <nz-form-item class="mt-2">
                            <nz-form-label class="fs-12" [nzSpan]="24">Từ khóa</nz-form-label>
                            <nz-form-control [nzSpan]="24">
                                <input name="filterText" nz-input placeholder="Nhập từ khóa" nzSize="small"
                                    [(ngModel)]="keywords" />
                            </nz-form-control>
                        </nz-form-item>
                    </form>
                </div>
                <div class="card-footer bg-white p-1 d-flex gap-1 justify-content-end">
                    <button nz-button nzType="primary" nzSize="small" (click)="loadMainData()">
                        Tìm kiếm
                    </button>
                </div>
            </div>
        </nz-splitter-panel>
        <nz-splitter-panel>
            <nz-splitter>
                <nz-splitter-panel>
                    <div class="grid-container" id="gridContainer">
                        <nz-spin [nzSpinning]="isLoading">
                            <angular-slickgrid gridId="requestInvoiceSummaryGrid" [columns]="columnDefinitions"
                                [options]="gridOptions" [dataset]="dataset"
                                (onAngularGridCreated)="onAngularGridCreated($event.detail)">
                            </angular-slickgrid>
                        </nz-spin>
                    </div>
                </nz-splitter-panel>
                <nz-splitter-panel nzDefaultSize="20%" [nzCollapsible]="true" nzResizable="true">
                    <div class="card h-100 border-0 rounded-0 d-flex flex-column">
                        <nz-tabset [nzTabPosition]="'top'" class="flex-grow-1 d-flex flex-column"
                            (nzSelectedIndexChange)="onFilesTabChange($event)">
                            <nz-tab nzTitle="Danh sách file">
                                <div class="grid-container-file h-100">
                                    <angular-slickgrid gridId="gridFile" [columns]="columnDefinitionsFile"
                                        [options]="gridOptionsFile" [dataset]="datasetFile"
                                        (onAngularGridCreated)="angularGridReadyFile($event.detail)"
                                        (onClick)="onFileRowClick($event.detail.eventData, $event.detail.args)"
                                        (onDblClick)="onFileRowDblClick($event.detail.eventData, $event.detail.args)">
                                    </angular-slickgrid>
                                </div>
                            </nz-tab>
                            <nz-tab nzTitle="File PO">
                                <div class="grid-container-pofile h-100" *ngIf="isPOFileGridRendered">
                                    <angular-slickgrid gridId="gridPOFile" [columns]="columnDefinitionsPOFile"
                                        [options]="gridOptionsPOFile" [dataset]="datasetPOFile"
                                        (onAngularGridCreated)="angularGridReadyPOFile($event.detail)"
                                        (onClick)="onPOFileRowClick($event.detail.eventData, $event.detail.args)"
                                        (onDblClick)="onPOFileRowDblClick($event.detail.eventData, $event.detail.args)">
                                    </angular-slickgrid>
                                </div>
                            </nz-tab>
                        </nz-tabset>
                    </div>
                </nz-splitter-panel>
            </nz-splitter>
        </nz-splitter-panel>
    </nz-splitter>
    <!-- <div class="modal-footer py-1">
            <button nz-button nzType="default" nzDanger="true" nzSize="default" (click)="closeModal()">Đóng</button>
            <button nz-button nzType="primary" nzSize="default" (click)="saveAndClose()">Lưu</button>
        </div> -->
</ng-container>
<!-- </div> -->