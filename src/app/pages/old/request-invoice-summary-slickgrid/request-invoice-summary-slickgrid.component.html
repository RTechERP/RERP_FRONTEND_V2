<ng-container class="w-100 h-100 d-flex flex-column">
    <!-- Header với p-menubar -->
    <div class="card-header bg-white p-0" style="flex-shrink: 0;">
        <p-menubar [model]="menuBars">
            <ng-template pTemplate="item" let-item>
                <a class="p-menuitem-link" [ngClass]="item.styleClass">
                    <i [class]="item.icon"></i>
                    <span class="p-menuitem-text">{{ item.label }}</span>
                </a>
            </ng-template>
        </p-menubar>
    </div>

    <!-- Filter bar - hiển thị dạng hàng ngang -->
    <div class="filter-bar bg-light border-bottom p-2">
        <form nz-form nzLayout="inline" class="d-flex flex-wrap gap-2 align-items-center">
            <nz-form-item class="mb-0">
                <nz-form-label class="fs-12" style="font-size: 12px; display: flex; align-items: center;">Từ
                    ngày</nz-form-label>
                <nz-form-control>
                    <nz-date-picker [(ngModel)]="dateStart" name="startDate" nzFormat="dd/MM/yyyy"
                        style="width: 150px; font-size: 12px;" nzSize="small"></nz-date-picker>
                </nz-form-control>
            </nz-form-item>

            <nz-form-item class="mb-0">
                <nz-form-label class="fs-12" style="font-size: 12px; display: flex; align-items: center;">Đến
                    ngày</nz-form-label>
                <nz-form-control>
                    <nz-date-picker [(ngModel)]="dateEnd" name="endDate" nzFormat="dd/MM/yyyy"
                        style="width: 150px; font-size: 12px;" nzSize="small"></nz-date-picker>
                </nz-form-control>
            </nz-form-item>

            <nz-form-item class="mb-0">
                <nz-form-label class="fs-12" style="font-size: 12px; display: flex; align-items: center;">Khách
                    hàng</nz-form-label>
                <nz-form-control>
                    <nz-select name="customerId" nzShowSearch nzAllowClear nzSize="small" nzPlaceHolder="Khách hàng"
                        style="width: 200px;" [(ngModel)]="customerId">
                        <nz-option *ngFor="let item of customers" [nzValue]="item.ID"
                            [nzLabel]="item.FullName"></nz-option>
                    </nz-select>
                </nz-form-control>
            </nz-form-item>

            <nz-form-item class="mb-0">
                <nz-form-label class="fs-12" style="font-size: 12px; display: flex; align-items: center;">Người yêu
                    cầu</nz-form-label>
                <nz-form-control>
                    <nz-select name="userId" nzShowSearch nzAllowClear nzSize="small" nzPlaceHolder="Người yêu cầu"
                        style="width: 200px;" [(ngModel)]="userId">
                        <nz-option *ngFor="let item of users" [nzValue]="item.ID" [nzLabel]="item.FullName"></nz-option>
                    </nz-select>
                </nz-form-control>
            </nz-form-item>

            <nz-form-item class="mb-0">
                <nz-form-label class="fs-12" style="font-size: 12px; display: flex; align-items: center;">Từ
                    khóa</nz-form-label>
                <nz-form-control>
                    <input nz-input placeholder="Nhập từ khóa" nzSize="small" [(ngModel)]="keywords" name="filterText"
                        style="width: 150px; font-size: 12px;" (keyup.enter)="loadMainData()" />
                </nz-form-control>
            </nz-form-item>

            <nz-form-item class="mb-0">
                <nz-form-control>
                    <button nz-button nzType="primary" nzSize="small" (click)="loadMainData()">
                        Tìm kiếm
                    </button>
                </nz-form-control>
            </nz-form-item>
        </form>
    </div>

    <!-- Main content -->
    <nz-splitter style="flex: 1;">
        <nz-splitter-panel>
            <nz-splitter>
                <nz-splitter-panel>
                    <div class="grid-container" id="gridContainer">
                        <nz-spin [nzSpinning]="isLoading">
                            <angular-slickgrid gridId="requestInvoiceSummaryGrid" [columns]="columnDefinitions"
                                [options]="gridOptions" [dataset]="dataset"
                                (onAngularGridCreated)="onAngularGridCreated($event.detail)">
                            </angular-slickgrid>
                        </nz-spin>
                    </div>
                </nz-splitter-panel>
                <nz-splitter-panel nzDefaultSize="20%" [nzCollapsible]="true" nzResizable="true">
                    <div class="card h-100 border-0 rounded-0 d-flex flex-column">
                        <nz-tabset [nzTabPosition]="'top'" class="flex-grow-1 d-flex flex-column"
                            (nzSelectedIndexChange)="onFilesTabChange($event)">
                            <nz-tab nzTitle="Danh sách file">
                                <div class="grid-container-file h-100">
                                    <angular-slickgrid gridId="gridFile" [columns]="columnDefinitionsFile"
                                        [options]="gridOptionsFile" [dataset]="datasetFile"
                                        (onAngularGridCreated)="angularGridReadyFile($event.detail)"
                                        (onClick)="onFileRowClick($event.detail.eventData, $event.detail.args)"
                                        (onDblClick)="onFileRowDblClick($event.detail.eventData, $event.detail.args)">
                                    </angular-slickgrid>
                                </div>
                            </nz-tab>
                            <nz-tab nzTitle="File PO">
                                <div class="grid-container-pofile h-100" *ngIf="isPOFileGridRendered">
                                    <angular-slickgrid gridId="gridPOFile" [columns]="columnDefinitionsPOFile"
                                        [options]="gridOptionsPOFile" [dataset]="datasetPOFile"
                                        (onAngularGridCreated)="angularGridReadyPOFile($event.detail)"
                                        (onClick)="onPOFileRowClick($event.detail.eventData, $event.detail.args)"
                                        (onDblClick)="onPOFileRowDblClick($event.detail.eventData, $event.detail.args)">
                                    </angular-slickgrid>
                                </div>
                            </nz-tab>
                        </nz-tabset>
                    </div>
                </nz-splitter-panel>
            </nz-splitter>
        </nz-splitter-panel>
    </nz-splitter>
</ng-container>