<div class="modal-content">
  <div class="modal-header bg-primary text-uppercase py-2">
    <h6 class="modal-title text-white" id="ExcelModalLabel">NHẬP DỮ LIỆU EXCEL</h6>
    <button type="button" class="btn-close" (click)="closeExcelModal()" aria-label="Close"></button>
  </div>

  <div class="modal-body">

    <form class="needs-validation" novalidate>
      <div class="d-flex flex-column gap-2 p-2">
        <div class="d-flex gap-2 align-items-center">
          <div class="d-flex align-items-center gap-2" style="flex: 2;">
            <label class="mb-0 fs-12" style="white-space: nowrap;">Đường dẫn:</label>
            <div class="d-flex gap-2 flex-grow-1">
              <input nz-input class="fs-12 w-100" name="path" id="pathInput" [(ngModel)]="filePath" [disabled]="true" />
              <input type="file" class="d-none fs-12" id="fileInput" accept=".xlsx,.xls"
                (change)="onFileSelected($event)" />
              <button type="button" class="btn btn-warning btn-sm" (click)="openFileExplorer()">
                <i class="fas fa-folder-open"></i>
              </button>
            </div>
          </div>
          <div class="d-flex align-items-center gap-2" style="flex: 1;">
            <label class="mb-0 fs-12" style="white-space: nowrap;">Tên Sheet:</label>
            <select class="form-select form-select-sm fs-12" name="sheet" id="sheetSelect" [(ngModel)]="selectedSheet"
              (change)="onSheetChange()">
              <option value="">Chọn Sheet</option>
              <option *ngFor="let sheet of excelSheets" [value]="sheet">{{sheet}}</option>
            </select>
          </div>
          <div class="d-flex gap-2 align-items-center p-2">
            <div class="flex-grow-1">
              <div class="progress-wrapper">
                <div style="text-align: center;" class="progress-text">{{ formatProgressText(displayProgress) }}</div>
                <nz-progress [nzPercent]="displayProgress" [nzStrokeColor]="{ '0%': '#108ee9', '100%': '#87d068' }"
                  [nzShowInfo]="true">
                </nz-progress>

              </div>
            </div>
          </div>

        </div>
      </div>

      <div class="card-body p-2 fs-11">
        <div id="datatableExcel">
          <!-- Tabulator table will render here -->
        </div>
      </div>
    </form>
  </div>

</div>
<div class="modal-footer">
  <button class="fs-12 btn" nz-button nzDanger (click)="closeExcelModal()">Đóng</button>
   <button class="fs-12 btn" nz-button  (click)="exportToExcelProduct()">Xuất File Lỗi</button>
  <button class="fs-12 btn" nz-button>
    
    <a href="C:\Users\Win\Downloads\FileMau.xlsx" download="MAU_Product.xlsx"
      style="text-decoration: none; color: inherit;">
      <nz-icon nzType="download" nzTheme="outline"></nz-icon> Mẫu
    </a>
  </button>
  <button class="fs-12 btn" nz-button nzType="primary" [nzLoading]="isSaving" (click)="saveExcelData()">Lưu</button>
</div>