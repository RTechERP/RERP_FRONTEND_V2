<ng-container class="w-100">
  <!-- Nút hành động ở trên cùng -->
  <div class="card border-0 rounded-0 m">
    <div class="card-header bg-white p-1">
      <div class="d-flex gap-1 align-items-center">
              <button *ngIf="!isSenior && !isSeniorMode" class="fs-12" nz-button nzType="default" nzSize="small"
                nz-dropdown [nzDropdownMenu]="menuTBP">
                <img src="assets/icon/action_confirm_tbp_16.png" /> TBP xác nhận
                <i nz-icon nzType="down"></i>
              </button>
              <ng-container *hasPermission="'N32'">
                <button *ngIf="!isSeniorMode" class="fs-12" nz-button nzType="default" nzSize="small"
                  (click)="declineApprove()">
                  <img src="assets/icon/action_unapproved_16.png" />
                  TBP Không duyệt
                </button>
              </ng-container>

              <ng-container *hasPermission="'N32'">
                <button *ngIf="!isSeniorMode" class="fs-12" nz-button nzType="default" nzSize="small"
                  (click)="approvedCancelRegister()">
                  <img src="assets/icon/action_approved_16.png" />
                  TBP duyệt hủy đăng ký
                </button>
              </ng-container>


              <button *ngIf="isSenior || isSeniorMode" class="fs-12" nz-button nzType="default" nzSize="small"
                nz-dropdown [nzDropdownMenu]="menuSenior">
                <img src="assets/icon/action_confirm_tbp_16.png" /> Senior xác nhận
                <i nz-icon nzType="down"></i>
              </button>

              <ng-container *hasPermission="'N1'">
                <button *ngIf="isBGD && !isSeniorMode" class="fs-12" nz-button nzType="default" nzSize="small"
                  nz-dropdown [nzDropdownMenu]="menuBGD">
                  <img src="assets/icon/action_confirm_tbp_16.png" /> BGĐ xác nhận
                  <i nz-icon nzType="down"></i>
                </button>
              </ng-container>

              <nz-dropdown-menu #menuTBP="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item (click)="approvedTBP()" *hasPermission="'N32'">
                    <img src="assets/icon/action_approved_16.png" />
                    <span class="ms-1">TBP duyệt</span>
                  </li>
                  <li nz-menu-item (click)="cancelApprovedTBP()" *hasPermission="'N32'">
                    <img src="assets/icon/action_unapproved_16.png" />
                    <span class="ms-1">TBP hủy duyệt</span>
                  </li>
                </ul>
              </nz-dropdown-menu>

              <nz-dropdown-menu #menuBGD="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item (click)="approvedBGD()" *hasPermission="'N1'">
                    <img src="assets/icon/action_approved_16.png" />
                    <span class="ms-1">BGĐ duyệt</span>
                  </li>
                  <li nz-menu-item (click)="cancelApprovedBGD()" *hasPermission="'N1'">
                    <img src="assets/icon/action_unapproved_16.png" />
                    <span class="ms-1">BGĐ hủy duyệt</span>
                  </li>
                </ul>
              </nz-dropdown-menu>

              <nz-dropdown-menu #menuSenior="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item (click)="approvedSenior()">
                    <img src="assets/icon/action_approved_16.png" />
                    <span class="ms-1">Senior duyệt</span>
                  </li>
                  <li nz-menu-item (click)="cancelApprovedSenior()">
                    <img src="assets/icon/action_unapproved_16.png" />
                    <span class="ms-1">Senior hủy duyệt</span>
                  </li>
                </ul>
              </nz-dropdown-menu>
      </div>
    </div>
  </div>

  <!-- Form tìm kiếm ở giữa -->
  <nz-card class="w-100 p-0 ">
    <form nz-form [formGroup]="searchForm" class="ant-advanced-search-form" nzLayout="horizontal">
      <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired="false">Ngày bắt đầu</nz-form-label>
            <nz-form-control>
              <nz-date-picker formControlName="startDate" nzFormat="dd/MM/yyyy" nzPlaceHolder="Chọn ngày bắt đầu"
                style="width: 100%" nzSize="small"></nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired="false">Ngày kết thúc</nz-form-label>
            <nz-form-control>
              <nz-date-picker formControlName="endDate" nzFormat="dd/MM/yyyy" nzPlaceHolder="Chọn ngày kết thúc"
                style="width: 100%" nzSize="small"></nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired="false">Team</nz-form-label>
            <nz-form-control>
              <nz-select formControlName="teamId" nzPlaceHolder="Chọn Team" nzAllowClear nzShowSearch nzSize="small">
                <nz-option *ngFor="let team of teamList" [nzValue]="team.ID" [nzLabel]="team.LeaderName"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="6">
          <nz-form-item>
            <nz-form-label nzRequired="false">Nhân viên</nz-form-label>
            <nz-form-control>
              <nz-select formControlName="employeeId" nzPlaceHolder="Chọn nhân viên" nzAllowClear nzShowSearch nzSize="small">
                <nz-option-group *ngFor="let group of employeeList" [nzLabel]="group.label">
                  <nz-option *ngFor="let option of group.options" [nzValue]="option.item.ID || option.item.EmployeeID"
                    [nzLabel]="(option.item.Code || '') + ' - ' + (option.item.FullName || '')">
                  </nz-option>
                </nz-option-group>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="6">
          <nz-form-item>
            <nz-form-label nzRequired="false">Từ khóa</nz-form-label>
            <nz-form-control>
              <nz-input-group nzSearch [nzAddOnAfter]="suffixIconButton" nzSize="small">
                <input type="text" nz-input placeholder="Nhập từ khóa" formControlName="keyWord" (keyup.enter)="loadData()" />
              </nz-input-group>
              <ng-template #suffixIconButton>
                <button nz-button nzType="primary" nzSearch nzSize="small" (click)="loadData()">
                  <span nz-icon nzType="search"></span>
                </button>
              </ng-template>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
      <div nz-row [nzGutter]="16">
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired="false">Trạng thái TBP</nz-form-label>
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear nzSize="small" nzPlaceHolder="Chọn trạng thái TBP" formControlName="status">
                <nz-option [nzValue]="-1" nzLabel="---Tất cả---"></nz-option>
                <nz-option [nzValue]="0" nzLabel="Chờ duyệt"></nz-option>
                <nz-option [nzValue]="1" nzLabel="Đã duyệt"></nz-option>
                <nz-option [nzValue]="2" nzLabel="Không đồng ý duyệt"></nz-option>
                <nz-option [nzValue]="3" nzLabel="Chờ duyệt hủy đăng ký"></nz-option>
                <nz-option [nzValue]="4" nzLabel="Đã duyệt hủy đăng ký"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired="false">Trạng thái HR</nz-form-label>
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear nzSize="small" nzPlaceHolder="Tất cả" formControlName="statusHR">
                <nz-option [nzValue]="0" nzLabel="Chờ duyệt"></nz-option>
                <nz-option [nzValue]="1" nzLabel="Đã duyệt"></nz-option>
                <nz-option [nzValue]="2" nzLabel="Không đồng ý duyệt"></nz-option>
                <nz-option [nzValue]="3" nzLabel="Chờ duyệt hủy đăng ký"></nz-option>
                <nz-option [nzValue]="4" nzLabel="Đã duyệt hủy đăng ký"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired="false">Trạng thái BGĐ</nz-form-label>
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear nzSize="small" nzPlaceHolder="Tất cả" formControlName="statusBGD">
                <nz-option [nzValue]="0" nzLabel="Chờ duyệt"></nz-option>
                <nz-option [nzValue]="1" nzLabel="Đã duyệt"></nz-option>
                <nz-option [nzValue]="2" nzLabel="Không đồng ý duyệt"></nz-option>
                <nz-option [nzValue]="3" nzLabel="Chờ duyệt hủy đăng ký"></nz-option>
                <nz-option [nzValue]="4" nzLabel="Đã duyệt hủy đăng ký"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired="false">Loại</nz-form-label>
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear nzSize="small" nzPlaceHolder="Tất cả" formControlName="type" [nzDisabled]="isSeniorMode">
                <nz-option [nzValue]="1" nzLabel="Đăng ký nghỉ"></nz-option>
                <nz-option [nzValue]="2" nzLabel="Đăng ký Đi muộn về sớm"></nz-option>
                <nz-option [nzValue]="3" nzLabel="Đăng ký Làm thêm"></nz-option>
                <nz-option [nzValue]="4" nzLabel="Đăng ký công tác"></nz-option>
                <nz-option [nzValue]="5" nzLabel="Làm việc ở nhà"></nz-option>
                <nz-option [nzValue]="6" nzLabel="Quên chấm vân tay"></nz-option>
                <nz-option [nzValue]="7" nzLabel="Tạm ứng lương"></nz-option>
                <nz-option [nzValue]="8" nzLabel="Làm Ca Đêm"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
            <nz-form-label nzRequired="false">Đã xóa</nz-form-label>
            <nz-form-control>
              <nz-select nzShowSearch nzAllowClear nzSize="small" nzPlaceHolder="Chọn trạng thái xóa" formControlName="deleteFlag">
                <nz-option [nzValue]="-1" nzLabel="Tất cả"></nz-option>
                <nz-option [nzValue]="0" nzLabel="Chưa xóa"></nz-option>
                <nz-option [nzValue]="1" nzLabel="Đã xóa"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [nzSpan]="4">
          <nz-form-item>
        
            <nz-form-control>
              <div class="d-flex gap-1">
                <button nz-button nzType="default" nzSize="small" (click)="resetSearch()">Đặt lại</button>
                <button nz-button nzType="primary" nzSize="small" (click)="loadData()">Tìm kiếm</button>
              </div>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </form>
  </nz-card>

  <!-- Bảng ở dưới cùng -->
  <div class="card h-100 border-0 rounded-0">
    <div class="card-body p-0 d-flex align-items-center justify-content-center" style="position: relative">
      <div class="w-100" #tb_approve_tp></div>
    </div>
  </div>
</ng-container>