<div class="workplan-container">
    <!-- Header row 1: Tiêu đề và badges -->
    <div class="card border-0 rounded-0 sticky-header">
        <div class="card-header bg-white p-1">
            <div class="d-flex justify-content-between align-items-center">
                <h6 class="m-0 text-uppercase fw-bold" style="white-space: nowrap;">Kế hoạch hạng mục cá nhân</h6>
                <div class="badges">
                    <span class="badge m-0 rounded-0 text-dark" style="background: #33CCFF;">Dự kiến</span>
                    <span class="badge m-0 rounded-0 text-dark" style="background: #d85898;">Thực tế</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Header row 2: Form tìm kiếm -->
    <div class="card border-0 rounded-0 sticky-header">
        <div class="card-header bg-white p-1">
            <nz-row [nzGutter]="[8, 8]">
                <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8" [nzLg]="6" [nzXl]="3">
                    <div class="form-field-vertical">
                        <label>Từ ngày</label>
                        <nz-date-picker [(ngModel)]="dateStart" nzPlaceHolder="Từ ngày" nzFormat="dd/MM/yyyy"
                            nzSize="small" name="dateStart" (ngModelChange)="onDateChange()" style="width: 100%;">
                        </nz-date-picker>
                    </div>
                </nz-col>

                <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8" [nzLg]="6" [nzXl]="3">
                    <div class="form-field-vertical">
                        <label>Đến ngày</label>
                        <nz-date-picker [(ngModel)]="dateEnd" nzPlaceHolder="Đến ngày" nzFormat="dd/MM/yyyy"
                            nzSize="small" name="dateEnd" (ngModelChange)="onDateChange()" style="width: 100%;">
                        </nz-date-picker>
                    </div>
                </nz-col>

                <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8" [nzLg]="6" [nzXl]="3">
                    <div class="form-field-vertical">
                        <label>Phòng ban</label>
                        <nz-select nzPlaceHolder="Phòng ban" [(ngModel)]="departmentId" nzSize="small" nzShowSearch
                            nzAllowClear (ngModelChange)="onDepartmentChange()" style="width: 100%;">
                            <nz-option [nzValue]="0" nzLabel="Tất cả"></nz-option>
                            <nz-option *ngFor="let item of departmentList" [nzLabel]="item.Name || ''"
                                [nzValue]="item.ID">
                            </nz-option>
                        </nz-select>
                    </div>
                </nz-col>

                <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8" [nzLg]="6" [nzXl]="4">
                    <div class="form-field-vertical">
                        <label>Team</label>
                        <nz-select nzPlaceHolder="Team" [(ngModel)]="teamId" nzSize="small" nzShowSearch nzAllowClear
                            (ngModelChange)="onTeamChange()" style="width: 100%;">
                            <nz-option [nzValue]="0" nzLabel="Tất cả"></nz-option>
                            <nz-option *ngFor="let item of teamList" [nzLabel]="item.Leader || ''" [nzValue]="item.ID">
                            </nz-option>
                        </nz-select>
                    </div>
                </nz-col>

                <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8" [nzLg]="6" [nzXl]="4">
                    <div class="form-field-vertical">
                        <label>Nhân viên</label>
                        <nz-select nzPlaceHolder="Nhân viên" [(ngModel)]="userId" nzSize="small" nzShowSearch
                            nzAllowClear (ngModelChange)="loadData()" style="width: 100%;">
                            <nz-option [nzValue]="0" nzLabel="Tất cả"></nz-option>
                            <nz-option *ngFor="let item of userList" [nzLabel]="item.FullName || ''"
                                [nzValue]="item.UserID">
                            </nz-option>
                        </nz-select>
                    </div>
                </nz-col>

                <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8" [nzLg]="6" [nzXl]="4">
                    <div class="form-field-vertical">
                        <label>Từ khóa</label>
                        <input nz-input placeholder="Từ khóa" [(ngModel)]="keyword" nzSize="small"
                            style="width: 100%;" />
                    </div>
                </nz-col>

                <nz-col [nzXs]="24" [nzSm]="12" [nzMd]="8" [nzLg]="6" [nzXl]="3">
                    <div class="form-field-vertical">
                        <label>&nbsp;</label>
                        <div class="d-flex gap-2">
                            <button nz-button nzType="default" nzSize="small" (click)="resetSearch()">
                                Đặt lại
                            </button>

                            <button nz-button nzType="primary" nzSize="small" (click)="loadData()">
                                <span nz-icon nzType="search"></span>
                                Tìm kiếm
                            </button>
                        </div>
                    </div>
                </nz-col>
            </nz-row>
        </div>
    </div>

    <!-- Table -->
    <div class="table-scroll-container">
        <nz-spin [nzSpinning]="isLoading" nzTip="Đang tải dữ liệu..." style="height: 100%;">
            <div #summaryTableContainer></div>
        </nz-spin>
    </div>
</div>