<ng-container class="w-100">
    <!-- Header row 1: Tiêu đề và badges -->
    <div class="card border-0 rounded-0">
        <div class="card-header bg-white p-1">
            <div class="d-flex justify-content-between align-items-center">
                <h6 class="m-0 text-uppercase fw-bold" style="white-space: nowrap;">Kế hoạch hạng mục cá nhân</h6>
                <div class="badges">
                    <span class="badge m-0 rounded-0 text-dark" style="background: #33CCFF;">Dự kiến</span>
                    <span class="badge m-0 rounded-0 text-dark" style="background: #FFCC33;">Thực tế</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Header row 2: Form tìm kiếm -->
    <div class="card border-0 rounded-0">
        <div class="card-header bg-white p-1">
            <div class="d-flex gap-1 align-items-center flex-wrap">
                <input nz-input type="date" [(ngModel)]="dateStart" nzSize="small" style="width: 120px;" />
                <input nz-input type="date" [(ngModel)]="dateEnd" nzSize="small" style="width: 120px;" />

                <nz-select 
                    nzPlaceHolder="Phòng ban" 
                    [(ngModel)]="departmentId"
                    nzSize="small"
                    nzShowSearch
                    nzAllowClear
                    (ngModelChange)="onDepartmentChange()"
                    style="width: 140px;">
                    <nz-option [nzValue]="0" nzLabel="Tất cả"></nz-option>
                    <nz-option 
                        *ngFor="let item of departmentList" 
                        [nzLabel]="item.Name || ''" 
                        [nzValue]="item.ID">
                    </nz-option>
                </nz-select>

                <nz-select 
                    nzPlaceHolder="Team" 
                    [(ngModel)]="teamId"
                    nzSize="small"
                    nzShowSearch
                    nzAllowClear
                    (ngModelChange)="onTeamChange()"
                    style="width: 140px;">
                    <nz-option [nzValue]="0" nzLabel="Tất cả"></nz-option>
                    <nz-option 
                        *ngFor="let item of teamList" 
                        [nzLabel]="item.Name || ''" 
                        [nzValue]="item.ID">
                    </nz-option>
                </nz-select>

                <nz-select 
                    nzPlaceHolder="Nhân viên" 
                    [(ngModel)]="userId"
                    nzSize="small"
                    nzShowSearch
                    nzAllowClear
                    style="width: 140px;">
                    <nz-option [nzValue]="0" nzLabel="Tất cả"></nz-option>
                    <nz-option 
                        *ngFor="let item of userList" 
                        [nzLabel]="item.FullName || ''" 
                        [nzValue]="item.ID">
                    </nz-option>
                </nz-select>

                <input 
                    nz-input 
                    placeholder="Từ khóa" 
                    [(ngModel)]="keyword"
                    nzSize="small"
                    style="width: 100px;" />

                <button nz-button nzType="default" nzSize="small" (click)="resetSearch()">
                    Đặt lại
                </button>
                
                <button nz-button nzType="primary" nzSize="small" (click)="loadData()">
                    <span nz-icon nzType="search"></span>
                    Tìm kiếm
                </button>
            </div>
        </div>
    </div>

    <!-- Table -->
    <div class="card-body p-1 position-relative" style="height: calc(100vh - 150px);">
        <nz-spin [nzSpinning]="isLoading" nzTip="Đang tải dữ liệu..." style="height: 100%;">
            <div class="table-wrapper" style="height: 100%; overflow: auto;">
                <div #summaryTableContainer></div>
            </div>
        </nz-spin>
    </div>
</ng-container>
