<div class="modal-dialog-scrollable">
  <div class="modal-header bg-primary text-uppercase py-2">
    <h6 class="modal-title text-white">Chi tiết yêu cầu dự án</h6>
    <button
      type="button"
      class="btn-close"
      (click)="closeModal()"
      aria-label="Close"
    ></button>
    
  </div>  

  <div class="modal-body" style="max-height: 80vh !important; overflow-y: auto;">
    <form nz-form [formGroup]="form" nzLayout="vertical" class="g-3 needs-validation was-validated">
      <!-- Hàng 1: Dự án + STT -->
      <div class="row">
        <div class="col-md-6 pb-3">
          <nz-form-item>
            <nz-form-label class="fs-12">
              Dự án
              <span class="text-danger ps-1 me-1">*</span>
            </nz-form-label>
            <nz-form-control
              [nzErrorTip]="
                form.get('ProjectID')?.invalid &&
                (form.get('ProjectID')?.dirty || form.get('ProjectID')?.touched)
                  ? 'Vui lòng chọn dự án!'
                  : undefined
              "
            >
              <nz-select
                formControlName="ProjectID"
                nzPlaceHolder="Chọn dự án"
                class="fs-12 w-100"
                required
                nzShowSearch
                nzAllowClear
                (ngModelChange)="onProjectChange()"
              >
                <nz-option 
                  *ngFor="let project of projectList" 
                  [nzValue]="project.ID" 
                  [nzLabel]="project.ProjectCode + ' - ' + project.ProjectName"
                ></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>

        <div class="col-md-3 pb-3">
          <nz-form-item>
            <nz-form-label class="fs-12">STT</nz-form-label>
            <nz-form-control>
              <nz-input-number
                formControlName="STT"
                [nzMin]="1"
                [nzStep]="1"
                [nzPlaceHolder]="'Nhập STT'"
                class="fs-12 w-100"
                (ngModelChange)="changeSTT()"
              ></nz-input-number>
            </nz-form-control>
          </nz-form-item>
        </div>

        <div class="col-md-3 pb-3">
          <nz-form-item>
            <nz-form-label class="fs-12">Ngày yêu cầu</nz-form-label>
            <nz-form-control>
              <nz-date-picker
                formControlName="DateRequest"
                nzFormat="dd/MM/yyyy"
                nzPlaceHolder="Chọn ngày yêu cầu"
                class="fs-12 w-100"
                style="width: 100%"
              ></nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <!-- Hàng 2: Mã yêu cầu -->
      <div class="row">
        <div class="col-md-12 pb-3">
          <nz-form-item>
            <nz-form-label class="fs-12 d-flex align-items-center">
              Mã yêu cầu
              <span class="text-danger ps-1 me-1">*</span>
            </nz-form-label>
            <nz-form-control
              [nzErrorTip]="
                form.get('CodeRequest')?.invalid &&
                (form.get('CodeRequest')?.dirty || form.get('CodeRequest')?.touched)
                  ? 'Vui lòng nhập mã yêu cầu!'
                  : undefined
              "
            >
              <input
                nz-input
                formControlName="CodeRequest"
                placeholder="Nhập mã yêu cầu"
                class="fs-12"
              />
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>

      <!-- Hàng 3: Nội dung -->
      <div class="row">
        <div class="col-md-12 pb-3">
          <nz-form-item>
            <nz-form-label class="fs-12">Nội dung <span class="text-danger ps-1 me-1">*</span></nz-form-label>
            <nz-form-control
              [nzErrorTip]="
                form.get('ContentRequest')?.invalid &&
                (form.get('ContentRequest')?.dirty || form.get('ContentRequest')?.touched)
                  ? 'Vui lòng nhập nội dung!'
                  : undefined
              "
            >
              <textarea
                nz-input
                placeholder="Nhập nội dung"
                formControlName="ContentRequest"
                class="fs-12"
                rows="4"
              ></textarea>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>


      <!-- Hàng 5: Bảng file -->
      <div class="row">
        <div class="col-md-12 pb-3">
          <div #tb_FileRequestTable id="tb_FileRequestTable" style="height: 100%; min-height: 300px;"></div>
        </div>
      </div>
    </form>
  </div>

  <div class="modal-footer">
    <button class="fs-12 btn" nz-button nzDanger (click)="closeModal()">
      Đóng
    </button>
    <button class="fs-12 btn" nz-button nzType="primary" (click)="saveData()">
      Lưu
    </button>
  </div>
</div>
